🔄 FORECASTING PIPELINE DATA FLOW DIAGRAM
================================================================================

📊 STAGE SCHEMA (Raw Data)
┌─────────────────────────────────────────────────────────────────────────────┐
│  OUTFLOW_BHASIN                    PRODUCT_MASTER_BHASIN                    │
│  ┌─────────────────────────────┐   ┌─────────────────────────────────────┐   │
│  │ • ~917,344 rows            │   │ • 526 rows (one per product)       │   │
│  │ • Date: 2021-2025          │   │ • Product metadata                  │   │
│  │ • 526 unique products      │   │ • Product attributes                │   │
│  │ • Raw outflow values       │   │ • Product identifiers               │   │
│  │ • Location data            │   │                                     │   │
│  └─────────────────────────────┘   └─────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ↓
                            🔧 DATA PROCESSING
                            ┌─────────────────────────────────────────────────┐
                            │  Feature Engineering & Regressor Creation      │
                            │  • RP_LAG_1, RP_LAG_2, RP_LAG_3               │
                            │  • HALF_RP_LAG_1, HALF_RP_LAG_2               │
                            │  • SEASON_1, SEASON_2, SEASON_3               │
                            │  • WEEK_1, WEEK_2, WEEK_3                     │
                            │  • RECENCY_1, RECENCY_2, RECENCY_3             │
                            │  • Additional derived features                 │
                            └─────────────────────────────────────────────────┘
                                    ↓
📊 TRANSFORMATION SCHEMA (Processed Data)
┌─────────────────────────────────────────────────────────────────────────────┐
│  PROCESSED_DATA_WITH_REGRESSORS                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ • ~917,344 rows (same as raw)                                      │   │
│  │ • 20+ regressor columns added                                     │   │
│  │ • Enhanced with feature engineering                               │   │
│  │ • Ready for forecasting algorithm                                │   │
│  │ • All 526 products processed                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ↓
                            🔮 FORECASTING ALGORITHM
                            ┌─────────────────────────────────────────────────┐
                            │  Moving Average with Regressor Features         │
                            │  • Historical data analysis                    │
                            │  • Regressor feature utilization              │
                            │  • Risk period calculations                    │
                            │  • Future outflow predictions                 │
                            └─────────────────────────────────────────────────┘
                                    ↓
📊 TRANSFORMATION SCHEMA (Forecasts)
┌─────────────────────────────────────────────────────────────────────────────┐
│  FUTURE_PREDICTIONS_RESULTS                                                 │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ • 526 predictions (one per product)                               │   │
│  │ • predicted_outflow_total                                         │   │
│  │ • predicted_outflow_daily                                         │   │
│  │ • risk_period_days                                                │   │
│  │ • forecasted_on (timestamp)                                       │   │
│  │ • location_id                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘

🎯 PIPELINE SUCCESS METRICS
================================================================================
✅ Raw Data: ~917,344 rows loaded successfully
✅ Processing: 20+ regressor features computed
✅ Forecasting: 526 products with predictions
✅ Coverage: 4+ years of historical data (2021-2025)
✅ Quality: All data integrity checks passed

🔄 TRANSFORMATION JOURNEY
================================================================================
Raw Data → Processed Data → Forecasts
   ↓           ↓            ↓
~917K rows → ~917K rows → 526 predictions
526 products → 526 products → 526 products
2021-2025 → 2021-2025 → Future dates
Basic data → Enhanced data → Actionable predictions

🎉 RESULT: Raw historical data transformed into actionable forecasts
🎯 ENABLES: Data-driven inventory management decisions
